<?xml version="1.0"?>
<robot xmlns:xacro="http://www.ros.org/wiki/xacro" name="flexiv_GN01">

  <xacro:macro name="gripper" params="gripper_prefix">

    <!-- base link -->
    <link name="${gripper_prefix}base_link">
      <inertial>
        <origin rpy="0 0 0" xyz="0 0 0.057"/>
        <mass value="1.186"/>
        <inertia ixx="0.003" ixy="0" ixz="0" iyy="0.003" iyz="0" izz="0.001"/>
      </inertial>
      <visual>
        <origin rpy="0 0 1.5707963267948966" xyz="0 0 0"/>
        <geometry>
          <mesh filename="package://flexiv_description/meshes/grav/visual/base.stl" scale="0.001 0.001 0.001"/>
        </geometry>
        <material name="flexiv_black"/>
      </visual>
      <collision>
        <origin rpy="0 0 1.5707963267948966" xyz="0 0 0"/>
        <geometry>
          <mesh filename="package://flexiv_description/meshes/grav/collision/base.stl" scale="0.001 0.001 0.001"/>
        </geometry>
      </collision>
    </link>

    <!-- left finger links -->
    <link name="${gripper_prefix}left_outer_bar">
      <inertial>
        <origin xyz="0 0 0.029" rpy="0 0 0"/>
        <mass value="0.01"/> <!-- Adjusted mass -->
        <inertia ixx="0.00001" ixy="0" ixz="0" iyy="0.00001" iyz="0" izz="0.00001"/> <!-- Adjusted inertia -->
      </inertial>
      <visual>
        <origin rpy="0 0 1.5707963267948966" xyz="0 0 0"/>
        <geometry>
          <mesh filename="package://flexiv_description/meshes/grav/visual/outer_bar.stl" scale="0.001 0.001 0.001"/>
        </geometry>
        <material name="flexiv_black"/>
      </visual>
    </link>

    <link name="${gripper_prefix}left_inner_bar">
      <inertial>
        <origin xyz="0 0 0.029" rpy="0 0 0"/>
        <mass value="0.01"/> <!-- Adjusted mass -->
        <inertia ixx="0.00001" ixy="0" ixz="0" iyy="0.00001" iyz="0" izz="0.00001"/> <!-- Adjusted inertia -->
      </inertial>
      <visual>
        <origin rpy="0 0 1.5707963267948966" xyz="0 0 0"/>
        <geometry>
          <mesh filename="package://flexiv_description/meshes/grav/visual/inner_bar.stl" scale="0.001 0.001 0.001"/>
        </geometry>
        <material name="flexiv_black"/>
      </visual>
    </link>

    <!-- Continue with other links similarly -->
    <link name="${gripper_prefix}left_finger_mount">
      <inertial>
        <origin xyz="0 0 0" rpy="0 0 0"/>
        <mass value="0.01"/> <!-- Adjusted mass -->
        <inertia ixx="0.00001" ixy="0" ixz="0" iyy="0.00001" iyz="0" izz="0.00001"/> <!-- Adjusted inertia -->
      </inertial>
      <visual>
        <origin rpy="0 0 1.5707963267948966" xyz="0 0 0"/>
        <geometry>
          <mesh filename="package://flexiv_description/meshes/grav/visual/finger_mount.stl" scale="0.001 0.001 0.001"/>
        </geometry>
        <material name="flexiv_black"/>
      </visual>
    </link>

    <link name="${gripper_prefix}left_finger_tip">
      <inertial>
        <origin rpy="0 0 0" xyz="0 0 0"/>
        <mass value="0.01"/> <!-- Adjusted mass -->
        <inertia ixx="0.00001" ixy="0" ixz="0" iyy="0.00001" iyz="0" izz="0.00001"/> <!-- Adjusted inertia -->
      </inertial>
      <visual>
        <origin rpy="0 0 1.5707963267948966" xyz="0 0 0"/>
        <geometry>
          <mesh filename="package://flexiv_description/meshes/grav/visual/finger_tip.obj" scale="0.001 0.001 0.001"/>
        </geometry>
      </visual>
      <collision>
        <origin rpy="0 0 1.5707963267948966" xyz="0 0 0"/>
        <geometry>
          <mesh filename="package://flexiv_description/meshes/grav/collision/finger_tip.stl" scale="0.001 0.001 0.001"/>
        </geometry>
      </collision>
    </link>

    <!-- right finger links -->
    <link name="${gripper_prefix}right_outer_bar">
      <inertial>
        <origin xyz="0 0 0.029" rpy="0 0 0"/>
        <mass value="0.01"/> <!-- Adjusted mass -->
        <inertia ixx="0.00001" ixy="0" ixz="0" iyy="0.00001" iyz="0" izz="0.00001"/> <!-- Adjusted inertia -->
      </inertial>
      <visual>
        <origin rpy="0 0 1.5707963267948966" xyz="0 0 0"/>
        <geometry>
          <mesh filename="package://flexiv_description/meshes/grav/visual/outer_bar.stl" scale="0.001 0.001 0.001"/>
        </geometry>
        <material name="flexiv_black"/>
      </visual>
    </link>
    <link name="${gripper_prefix}right_inner_bar">
      <inertial>
        <origin xyz="0 0 0.029" rpy="0 0 0"/>
        <mass value="0.01"/> <!-- Adjusted mass -->
        <inertia ixx="0.00001" ixy="0" ixz="0" iyy="0.00001" iyz="0" izz="0.00001"/> <!-- Adjusted inertia -->
      </inertial>
      <visual>
        <origin rpy="0 0 1.5707963267948966" xyz="0 0 0"/>
        <geometry>
          <mesh filename="package://flexiv_description/meshes/grav/visual/inner_bar.stl" scale="0.001 0.001 0.001"/>
        </geometry>
        <material name="flexiv_black"/>
      </visual>
    </link>
    <link name="${gripper_prefix}right_finger_mount">
      <inertial>
        <origin xyz="0 0 0" rpy="0 0 0"/>
        <mass value="0.01"/> <!-- Adjusted mass -->
        <inertia ixx="0.00001" ixy="0" ixz="0" iyy="0.00001" iyz="0" izz="0.00001"/> <!-- Adjusted inertia -->
      </inertial>
      <visual>
        <origin rpy="0 0 1.5707963267948966" xyz="0 0 0"/>
        <geometry>
          <mesh filename="package://flexiv_description/meshes/grav/visual/finger_mount.stl" scale="0.001 0.001 0.001"/>
        </geometry>
        <material name="flexiv_black"/>
      </visual>
    </link>
    <link name="${gripper_prefix}right_finger_tip">
      <inertial>
        <origin rpy="0 0 0" xyz="0 0 0"/>
        <mass value="0.01"/> <!-- Adjusted mass -->
        <inertia ixx="0.00001" ixy="0" ixz="0" iyy="0.00001" iyz="0" izz="0.00001"/> <!-- Adjusted inertia -->
      </inertial>
      <visual>
        <origin rpy="0 0 1.5707963267948966" xyz="0 0 0"/>
        <geometry>
          <mesh filename="package://flexiv_description/meshes/grav/visual/finger_tip.obj" scale="0.001 0.001 0.001"/>
        </geometry>
      </visual>
      <collision>
        <origin rpy="0 0 1.5707963267948966" xyz="0 0 0"/>
        <geometry>
          <mesh filename="package://flexiv_description/meshes/grav/collision/finger_tip.stl" scale="0.001 0.001 0.001"/>
        </geometry>
      </collision>
    </link>

    <!-- TCP links -->
    <link name="${gripper_prefix}tcp">
      <inertial>
        <origin rpy="0 0 0" xyz="0 0 0"/>
        <mass value="0.01"/> <!-- Adjusted mass -->
        <inertia ixx="0.00001" ixy="0" ixz="0" iyy="0.00001" iyz="0" izz="0.00001"/> <!-- Adjusted inertia -->
      </inertial>
    </link>
    <link name="${gripper_prefix}closed_fingers_tcp">
      <inertial>
        <origin rpy="0 0 0" xyz="0 0 0"/>
        <mass value="0.01"/> <!-- Adjusted mass -->
        <inertia ixx="0.00001" ixy="0" ixz="0" iyy="0.00001" iyz="0" izz="0.00001"/> <!-- Adjusted inertia -->
      </inertial>
    </link>
    <link name="${gripper_prefix}left_finger_tcp">
      <inertial>
        <origin rpy="0 0 0" xyz="0 0 0"/>
        <mass value="0.01"/> <!-- Adjusted mass -->
        <inertia ixx="0.00001" ixy="0" ixz="0" iyy="0.00001" iyz="0" izz="0.00001"/> <!-- Adjusted inertia -->
      </inertial>
    </link>
    <link name="${gripper_prefix}right_finger_tcp">
      <inertial>
        <origin rpy="0 0 0" xyz="0 0 0"/>
        <mass value="0.01"/> <!-- Adjusted mass -->
        <inertia ixx="0.00001" ixy="0" ixz="0" iyy="0.00001" iyz="0" izz="0.00001"/> <!-- Adjusted inertia -->
      </inertial>
    </link>

    <!-- Example joint with valid pose values -->
    <joint name="${gripper_prefix}open_fingers_tcp_joint" type="fixed">
      <origin rpy="0 0 0" xyz="0 0 0.15"/>
      <parent link="${gripper_prefix}base_link"/>
      <child link="${gripper_prefix}tcp"/>
      <axis xyz="0 0 1"/>
    </joint>

    <joint name="${gripper_prefix}closed_fingers_tcp_joint" type="fixed">
      <origin rpy="0 0 0" xyz="0 0 0.20"/>
      <parent link="${gripper_prefix}base_link"/>
      <child link="${gripper_prefix}closed_fingers_tcp"/>
      <axis xyz="0 0 1"/>
    </joint>

    <!-- left finger joints with valid pose values and valid inertial values -->
    <joint name="${gripper_prefix}left_outer_knuckle_joint" type="revolute">
      <origin rpy="0 0 0" xyz="0 -0.0325 0.0825"/>
      <parent link="${gripper_prefix}base_link"/>
      <child link="${gripper_prefix}left_outer_bar"/>
      <axis xyz="1 0 0"/>
      <limit effort="0" lower="-0.155" upper="0.7854" velocity="2.0"/>
      <mimic joint="${gripper_prefix}finger_width_joint" multiplier="9.404" offset="-0.155"/>
    </joint>
    <joint name="${gripper_prefix}left_inner_knuckle_joint" type="revolute">
      <origin rpy="0 0 0" xyz="0 -0.0165 0.0995"/>
      <parent link="${gripper_prefix}base_link"/>
      <child link="${gripper_prefix}left_inner_bar"/>
      <axis xyz="1 0 0"/>
      <limit effort="0" lower="-0.155" upper="0.7854" velocity="2.0"/>
      <mimic joint="${gripper_prefix}left_outer_knuckle_joint" multiplier="1" offset="0"/>
    </joint>
    <joint name="${gripper_prefix}left_inner_finger_joint" type="revolute">
      <origin rpy="0 0 0" xyz="0 0 0.058"/>
      <parent link="${gripper_prefix}left_outer_bar"/>
      <child link="${gripper_prefix}left_finger_mount"/>
      <axis xyz="1 0 0"/>
      <limit effort="0" lower="-0.7854" upper="0.155" velocity="2.0"/>
      <mimic joint="${gripper_prefix}left_outer_knuckle_joint" multiplier="-1" offset="0"/>
    </joint>
    <joint name="${gripper_prefix}left_inner_finger_pad_joint" type="fixed">
      <origin rpy="0 0 0" xyz="0 0.010 0.0235"/>
      <parent link="${gripper_prefix}left_finger_mount"/>
      <child link="${gripper_prefix}left_finger_tip"/>
      <axis xyz="0 0 1"/>
    </joint>
    <joint name="${gripper_prefix}left_finger_tcp_joint" type="fixed">
      <origin rpy="0 0 0" xyz="0 0.0135 0.036"/>
      <parent link="${gripper_prefix}left_finger_tip"/>
      <child link="${gripper_prefix}left_finger_tcp"/>
      <axis xyz="0 0 1"/>
    </joint>

    <!-- right finger joints with valid pose values and valid inertial values -->
    <joint name="${gripper_prefix}right_outer_knuckle_joint" type="revolute">
      <origin rpy="0 0 3.141592653589793" xyz="0 0.0325 0.0825"/>
      <parent link="${gripper_prefix}base_link"/>
      <child link="${gripper_prefix}right_outer_bar"/>
      <axis xyz="1 0 0"/>
      <limit effort="0" lower="-0.155" upper="0.7854" velocity="2.0"/>
      <mimic joint="${gripper_prefix}left_outer_knuckle_joint" multiplier="1" offset="0"/>
    </joint>
    <joint name="${gripper_prefix}right_inner_knuckle_joint" type="revolute">
      <origin rpy="0 0 3.141592653589793" xyz="0 0.0165 0.0995"/>
      <parent link="${gripper_prefix}base_link"/>
      <child link="${gripper_prefix}right_inner_bar"/>
      <axis xyz="1 0 0"/>
      <limit effort="0" lower="-0.155" upper="0.7854" velocity="2.0"/>
      <mimic joint="${gripper_prefix}left_outer_knuckle_joint" multiplier="1" offset="0"/>
    </joint>
    <joint name="${gripper_prefix}right_inner_finger_joint" type="revolute">
      <origin rpy="0 0 0" xyz="0 0 0.058"/>
      <parent link="${gripper_prefix}right_outer_bar"/>
      <child link="${gripper_prefix}right_finger_mount"/>
      <axis xyz="1 0 0"/>
      <limit effort="0" lower="-0.7854" upper="0.155" velocity="2.0"/>
      <mimic joint="${gripper_prefix}left_outer_knuckle_joint" multiplier="-1" offset="0"/>
    </joint>
    <joint name="${gripper_prefix}right_inner_finger_pad_joint" type="fixed">
      <origin rpy="0 0 0" xyz="0 0.010 0.0235"/>
      <parent link="${gripper_prefix}right_finger_mount"/>
      <child link="${gripper_prefix}right_finger_tip"/>
      <axis xyz="0 0 1"/>
    </joint>
    <joint name="${gripper_prefix}right_finger_tcp_joint" type="fixed">
      <origin rpy="0 0 0" xyz="0 0.0135 0.036"/>
      <parent link="${gripper_prefix}right_finger_tip"/>
      <child link="${gripper_prefix}right_finger_tcp"/>
      <axis xyz="0 0 1"/>
    </joint>

    <!-- Control joint -->
    <joint name="${gripper_prefix}finger_width_joint" type="revolute">
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <parent link="${gripper_prefix}base_link"/>
      <child link="${gripper_prefix}unused_finger_width_link"/>
      <axis xyz="1 0 0"/>
      <limit effort="80" lower="0" upper="0.100" velocity="0.2"/>
    </joint>

    <link name="${gripper_prefix}unused_finger_width_link">
      <inertial>
        <origin rpy="0 0 0" xyz="0 0 0"/>
        <mass value="0.01"/> <!-- Adjusted mass -->
        <inertia ixx="0.00001" ixy="0" ixz="0" iyy="0.00001" iyz="0" izz="0.00001"/> <!-- Adjusted inertia -->
      </inertial>
    </link>

  </xacro:macro>

  <!-- materials -->
  <material name="flexiv_black">
    <color rgba="0.22 0.22 0.22 1"/>
  </material>

</robot>